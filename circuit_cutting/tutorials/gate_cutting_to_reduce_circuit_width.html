<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gate Cutting to Reduce Circuit Width &#8212; Circuit Knitting Toolbox 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Explanatory material for the circuit cutting module" href="../explanation/index.html" />
    <link rel="prev" title="Gate Cutting to Reduce Circuit Depth" href="gate_cutting_to_reduce_circuit_depth.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Gate-Cutting-to-Reduce-Circuit-Width">
<h1>Gate Cutting to Reduce Circuit Width<a class="headerlink" href="#Gate-Cutting-to-Reduce-Circuit-Width" title="Permalink to this heading">¶</a></h1>
<p>In this tutorial we will simulate expectation values of a four-qubit circuit using only two-qubit experiments by cutting gates in the circuit.</p>
<p>Like any circuit knitting technique, gate cutting can be described as three consecutive steps:</p>
<ul class="simple">
<li><p><strong>decompose</strong> some non-local gates in the circuit and possibly separate the circuit into subcircuits</p></li>
<li><p><strong>execute</strong> many sampled subexperiments on the backend(s)</p></li>
<li><p><strong>reconstruct</strong> the simulated expectation value of the full-sized circuit</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">EfficientSU2</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">PauliList</span>
<span class="kn">from</span> <span class="nn">qiskit_aer.primitives</span> <span class="kn">import</span> <span class="n">Estimator</span><span class="p">,</span> <span class="n">Sampler</span>

<span class="kn">from</span> <span class="nn">circuit_knitting_toolbox.circuit_cutting</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">partition_problem</span><span class="p">,</span>
    <span class="n">execute_experiments</span><span class="p">,</span>
    <span class="n">reconstruct_expectation_values</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Create-a-circuit-to-cut">
<h2>Create a circuit to cut<a class="headerlink" href="#Create-a-circuit-to-cut" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit</span> <span class="o">=</span> <span class="n">EfficientSU2</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">entanglement</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">([</span><span class="mf">0.8</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">parameters</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/circuit_cutting_tutorials_gate_cutting_to_reduce_circuit_width_3_0.png" src="../../_images/circuit_cutting_tutorials_gate_cutting_to_reduce_circuit_width_3_0.png" />
</div>
</div>
</section>
<section id="Specify-some-observables">
<h2>Specify some observables<a class="headerlink" href="#Specify-some-observables" title="Permalink to this heading">¶</a></h2>
<p>Currently, only <code class="docutils literal notranslate"><span class="pre">Pauli</span></code> observables with phase equal to 1 are supported. Full support for <code class="docutils literal notranslate"><span class="pre">SparsePauliOp</span></code> is expected in CKT v0.3.0.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observables</span> <span class="o">=</span> <span class="n">PauliList</span><span class="p">([</span><span class="s2">&quot;ZZII&quot;</span><span class="p">,</span> <span class="s2">&quot;IZZI&quot;</span><span class="p">,</span> <span class="s2">&quot;IIZZ&quot;</span><span class="p">,</span> <span class="s2">&quot;XIXI&quot;</span><span class="p">,</span> <span class="s2">&quot;ZIZZ&quot;</span><span class="p">,</span> <span class="s2">&quot;IXIX&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="Separate-the-circuit-and-observables-according-to-a-specified-qubit-partitioning">
<h2>Separate the circuit and observables according to a specified qubit partitioning<a class="headerlink" href="#Separate-the-circuit-and-observables-according-to-a-specified-qubit-partitioning" title="Permalink to this heading">¶</a></h2>
<p>Each label in <code class="docutils literal notranslate"><span class="pre">partition_labels</span></code> corresponds to the <code class="docutils literal notranslate"><span class="pre">circuit</span></code> qubit in the same index. Qubits sharing a common partition label will be grouped together, and non-local gates spanning more than one partition will be cut.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subcircuits</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">subobservables</span> <span class="o">=</span> <span class="n">partition_problem</span><span class="p">(</span>
    <span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">,</span> <span class="n">partition_labels</span><span class="o">=</span><span class="s2">&quot;AABB&quot;</span><span class="p">,</span> <span class="n">observables</span><span class="o">=</span><span class="n">observables</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">partition_problem</span></code> returns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dict</span></code> mapping partition labels to subcircuits</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dict</span></code> mapping partition labels to subobservables</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">QPDBasis</span></code> instances from each gate decomposition</p></li>
</ul>
</section>
<section id="Visualize-the-decomposed-problem">
<h2>Visualize the decomposed problem<a class="headerlink" href="#Visualize-the-decomposed-problem" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subobservables</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;A&#39;: PauliList([&#39;II&#39;, &#39;ZI&#39;, &#39;ZZ&#39;, &#39;XI&#39;, &#39;ZZ&#39;, &#39;IX&#39;]),
 &#39;B&#39;: PauliList([&#39;ZZ&#39;, &#39;IZ&#39;, &#39;II&#39;, &#39;XI&#39;, &#39;ZI&#39;, &#39;IX&#39;])}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subcircuits</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/circuit_cutting_tutorials_gate_cutting_to_reduce_circuit_width_11_0.png" src="../../_images/circuit_cutting_tutorials_gate_cutting_to_reduce_circuit_width_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subcircuits</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/circuit_cutting_tutorials_gate_cutting_to_reduce_circuit_width_12_0.png" src="../../_images/circuit_cutting_tutorials_gate_cutting_to_reduce_circuit_width_12_0.png" />
</div>
</div>
</section>
<section id="Calculate-the-sampling-overhead-for-the-chosen-cuts">
<h2>Calculate the sampling overhead for the chosen cuts<a class="headerlink" href="#Calculate-the-sampling-overhead-for-the-chosen-cuts" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampling overhead: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="n">basis</span><span class="o">.</span><span class="n">overhead</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">basis</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bases</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sampling overhead: 81.0
</pre></div></div>
</div>
</section>
<section id="Generate-and-run-the-cutting-experiments">
<h2>Generate and run the cutting experiments<a class="headerlink" href="#Generate-and-run-the-cutting-experiments" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">execute_experiments</span></code> accepts <code class="docutils literal notranslate"><span class="pre">circuits</span></code>/<code class="docutils literal notranslate"><span class="pre">subobservables</span></code> args as dictionaries mapping qubit partition labels to the respective <code class="docutils literal notranslate"><span class="pre">subcircuit</span></code>/<code class="docutils literal notranslate"><span class="pre">subobservables</span></code>.</p>
<p>To simulate the expectation value of the full-sized circuit, many subexperiments are generated from the decomposed gates’ joint quasiprobability distribution and then executed on one or more backends.</p>
<p>Much of the circuit cutting literature describes a process where we sample from the distribution, take a single shot, sample from the distribution again and repeat; however, this is not feasible in practice. The number of shots needed grows exponentially with the number of cuts, and single shot experiments via Qiskit Runtime quickly become untenable. Instead, we take an equivalent number of shots for each sampled subexperiment, and send them to the backend(s) in batches. We just need to ensure
the number of shots we take is appropriate for the heaviest-weighted samples, and thus, appropriate for all samples.</p>
<p>The number of samples taken from the distribution is controlled by <code class="docutils literal notranslate"><span class="pre">num_samples</span></code>. If the smallest sample probability in the joint quasi-probability distribution is above 1 / <code class="docutils literal notranslate"><span class="pre">num_samples</span></code>, exact weights will be used. Otherwise, the weights will be sampled, resulting in at most <code class="docutils literal notranslate"><span class="pre">num_samples</span></code> unique samples. In the future, this function will be changed to return a mixture of exact and sampled weights, so that the largest weights will be calculated exactly, while weights in the tail of the
distribution will be sampled.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep in mind, Terra Sampler does not support mid-circuit measurements at all,</span>
<span class="c1"># and Aer Sampler does not support mid-circuit measurements when shots==None.</span>
<span class="n">samplers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">Sampler</span><span class="p">(</span><span class="n">run_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shots&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">}),</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">Sampler</span><span class="p">(</span><span class="n">run_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shots&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">}),</span>
<span class="p">}</span>

<span class="n">quasi_dists</span><span class="p">,</span> <span class="n">coefficients</span> <span class="o">=</span> <span class="n">execute_experiments</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="n">subcircuits</span><span class="p">,</span>
    <span class="n">subobservables</span><span class="o">=</span><span class="n">subobservables</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
    <span class="n">samplers</span><span class="o">=</span><span class="n">samplers</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">execute_experiments</span></code> returns:</p>
<ul class="simple">
<li><p>A 3D list of length-2 tuples containing a quasiprobability distribution and QPD bit information for each unique subexperiment</p></li>
<li><p>The coefficients for each subexperiment</p></li>
</ul>
</section>
<section id="Reconstruct-the-simulated-expectation-values">
<h2>Reconstruct the simulated expectation values<a class="headerlink" href="#Reconstruct-the-simulated-expectation-values" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">reconstruct_expectation_values</span></code> expects <code class="docutils literal notranslate"><span class="pre">quasi_dists</span></code> and <code class="docutils literal notranslate"><span class="pre">coefficients</span></code> in the same format as returned from <code class="docutils literal notranslate"><span class="pre">execute_experiments</span></code>. <code class="docutils literal notranslate"><span class="pre">quasi_dists</span></code> is a 3D list of shape (<code class="docutils literal notranslate"><span class="pre">num_unique_samples</span></code>, <code class="docutils literal notranslate"><span class="pre">num_partitions</span></code>, <code class="docutils literal notranslate"><span class="pre">num_commuting_observ_groups</span></code>), and <code class="docutils literal notranslate"><span class="pre">coefficients</span></code> is a list with length equal to the number of unique samples. <code class="docutils literal notranslate"><span class="pre">subobservables</span></code> is the dictionary mapping qubit partition label to the associated subobservable(s), as output from <code class="docutils literal notranslate"><span class="pre">decompose_problem</span></code> above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulated_expvals</span> <span class="o">=</span> <span class="n">reconstruct_expectation_values</span><span class="p">(</span>
    <span class="n">quasi_dists</span><span class="p">,</span>
    <span class="n">coefficients</span><span class="p">,</span>
    <span class="n">subobservables</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">reconstruct_expectation_values</span></code> is a list of simulated expectation values – one for each observable.</p>
</section>
<section id="Compare-the-simulated-expectation-values-with-the-exact-expectation-values-from-the-original-circuit">
<h2>Compare the simulated expectation values with the exact expectation values from the original circuit<a class="headerlink" href="#Compare-the-simulated-expectation-values-with-the-exact-expectation-values-from-the-original-circuit" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">Estimator</span><span class="p">(</span><span class="n">run_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shots&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="n">approximation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">exact_expvals</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">estimator</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">circuit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">observables</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">observables</span><span class="p">))</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Simulated expectation values: </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">simulated_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_expvals</span><span class="p">))]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Exact expectation values: </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">exact_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_expvals</span><span class="p">))]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Errors in estimation: </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">simulated_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">exact_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_expvals</span><span class="p">))]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Relative errors in estimation: </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">simulated_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">exact_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">exact_expvals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_expvals</span><span class="p">))]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Simulated expectation values: [0.16709793, 0.18652463, 0.30369848, 0.46279693, 0.08348149, 0.70464808]
Exact expectation values: [0.17153613, 0.1815846, 0.30958691, 0.44036036, 0.08173037, 0.70623815]
Errors in estimation: [-0.00443821, 0.00494003, -0.00588843, 0.02243656, 0.00175112, -0.00159008]
Relative errors in estimation: [-0.02587331, 0.02720511, -0.01902029, 0.05095046, 0.0214256, -0.00225147]
</pre></div></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Circuit Knitting Toolbox</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation Instructions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Circuit Cutting Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#id2">Circuit Cutting Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/index.html">Circuit Cutting Explanatory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-tos/index.html">Circuit Cutting How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cutqc/index.html">CutQC (legacy circuit cutting implementation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../entanglement_forging/tutorials/index.html">Entanglement Forging Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../entanglement_forging/explanation/index.html">Entanglement Forging Explanatory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../entanglement_forging/how-tos/index.html">Entanglement Forging How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidocs/index.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes.html">Release Notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Circuit Cutting Tutorials</a><ul>
      <li>Previous: <a href="gate_cutting_to_reduce_circuit_depth.html" title="previous chapter">Gate Cutting to Reduce Circuit Depth</a></li>
      <li>Next: <a href="../explanation/index.html" title="next chapter">Explanatory material for the circuit cutting module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/circuit_cutting/tutorials/gate_cutting_to_reduce_circuit_width.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>